<div class="mce-toc">
<h2>Table of Contents</h2>
<ul>
<li>
<ul>
<li> </li>
<li><a href="#mcetoc_1ehqfr33ic">Processando um arquivo CSV</a>
<ul>
<li><a href="#mcetoc_1ehqfr33id">Lendo um arquivo CSV</a></li>
<li><a href="#mcetoc_1ehqfr33ie">Escrevendo em arquivo CSV</a></li>
</ul>
</li>
<li> </li>
</ul>
</li>
<li><a href="#mcetoc_1ehqfr33if">Resources:</a></li>
</ul>
</div>
<h2 id="mcetoc_1ev4nc28g1"></h2>
<h1 id="mcetoc_1ehqfr33ic">Processando um arquivo CSV</h1>
<p>E aqui, mais uma vez o Python nos trás uma funcionalidade, o módulo <span data-darkreader-inline-bgcolor="" data-darkreader-inline-color="" style="color: #ba372a; background-color: #ced4d9;">csv</span> que é um <em>built-in</em>, que nos possibilita realizar operações com arquivos CSV</p>
<h2 id="mcetoc_1ehqfr33id">Lendo um arquivo CSV</h2>
<p>Para fazer esta leitura vamos instruir a máquina a fazer o seguinte</p>
<ul>
<li>importar o módulo csv</li>
<li>abrir o arquivo csv em modo de leitura</li>
<li>criar um leitor de csv, que é um iterador sobre o arquivo</li>
<li>iterar sobre as linhas para obtermos os dados</li>
<li>fechar o arquivo csv</li>
</ul>
<p>Nosso código equivalente é o seguinte</p>
<pre class="language-python"><code>import csv

with open('paes.csv', 'r') as paes_csv:
    reader = csv.DictReader(paes_csv)
    for dic in reader:
        print(dic)
</code></pre>
<p>A saída (output) será a seguinte</p>
<pre class="language-ruby"><code>{'id_produto': '1', 'descricao': 'Pão de Queijo', 'valor': '1.00', 'desconto': '0.0'}
{'id_produto': '2', 'descricao': 'Pão de Forma', 'valor': '6.00', 'desconto': '0.4'}
{'id_produto': '3', 'descricao': 'Pão de Milho', 'valor': '0.70', 'desconto': '0.0'}
{'id_produto': '4', 'descricao': 'Pão de Mel', 'valor': '2.50', 'desconto': '0.3'}
</code></pre>
<h3 id="mcetoc_1ehqfr33ie">Escrevendo em arquivo CSV</h3>
<p>Para incluir um novo registro no nosso CSV de pães vamos ler o nosso arquivo csv utilizando o DictReader e então adicionar um novo elemento a lista e então adicioná-la no fim do arquivo, instruindo a máquina a fazer o seguinte:</p>
<ul>
<li>importar o módulo csv</li>
<li>abrir o arquivo em modo leitura</li>
<li>criar um escritor de csv
<ul>
<li>definir o caractere de delimitador</li>
<li>definir o caractere fieldnames</li>
</ul>
</li>
<li>criar uma lista com os dados para serem colocados na linha</li>
<li>passar a lista para o escritor adicioná-la no fim do arquivo csv</li>
<li>fechar o arquivo csv</li>
</ul>
<p>Tranformando isso em código Python, temos o seguinte:</p>
<pre class="language-python"><code>import csv

# Essa função faz a leitura de todos os dicionários dentro do arquivo 'paes.csv', não precisa se preocupar, você já fez anterioremente.
def all_products(FILENAME):
    with open('paes.csv', 'r') as paes_csv:
        return [dic for dic in csv.DictReader(paes_csv)]
        
# Aqui estamos adicionando o nosso novo dicionário na nossa lista de produtos.
pao = {'id_produto': 5, 'descricao': 'Pão cevado', 'valor': 4.00, 'desconto': 0.0}
all_products_list = all_products('paes.csv')
all_products_list.append(pao)

# E aqui fazemos a escrita do nosso arquivo
with open('paes.csv', 'w') as paes_csv:
    writer = csv.DictWriter(paes_csv, delimiter=',', fieldnames=['id_produto', 'descricao', 'valor', 'desconto'])
    writer.writeheader()
    for product in all_products_list:
        writer.writerow(product)
</code></pre>
<p>Dessa forma teremos uma nova linha no nosso arquivo<span data-darkreader-inline-bgcolor="" style="background-color: #ced4d9;"><span data-darkreader-inline-color="" style="color: #ba372a;"> paes.csv</span>,</span> como a seguir.</p>
<pre class="language-python"><code>id_produto,descricao,valor,desconto
1,Pão de Queijo,1.00,0.0
2,Pão de Forma,6.00,0.4
3,Pão de Milho,0.70,0.0
4,Pão de Mel,2.50,0.3
5,Pão cevado,4.0,0.0</code></pre>
<p> </p>
<h1 id="mcetoc_1ehqfr33if">Resources:</h1>
<ul>
<li><a href="https://docs.python.org/pt-br/3/library/csv.html" rel="noopener" target="_blank">Documentação do Python</a>
<ul>
<li><a href="https://docs.python.org/pt-br/3/library/csv.html#csv.DictReader" rel="noopener" target="_blank">DictReader</a></li>
<li><a href="https://docs.python.org/pt-br/3/library/csv.html#csv.DictWriter" rel="noopener" target="_blank">DictWriter</a></li>
</ul>
</li>
</ul>
<p> </p>
<p> </p>

<p> </p>

<p> </p>
<p> </p>

<p> </p>

<p> </p>